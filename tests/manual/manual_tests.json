{
  "tests": [
    {
      "id": "uat_expense_crud",
      "title": "UAT: Expense CRUD with sync validation",
      "resource": "expense",
      "steps": [
        {
          "kind": "user",
          "label": "Record expense count from both Windows and mobile apps, ensure mobile is on WiFi. NOTE: HomeBudget UI will close automatically during each CLI operation and reopen when complete."
        },
        {
          "kind": "auto",
          "label": "Create test expense",
          "command": "hb expense add --date 2026-02-17 --category \"Food (Basic)\" --subcategory \"Cheap restaurant\" --amount 25.50 --account \"TWH - Personal\" --notes \"UAT Expense Create 01\""
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: New expense appears in Windows app AND mobile app"
        },
        {
          "kind": "auto",
          "label": "List expenses to get key",
          "command": "hb expense list --start-date 2026-02-17 --end-date 2026-02-17 --account \"TWH - Personal\" --limit 5"
        },
        {
          "kind": "user",
          "label": "Record the expense key"
        },
        {
          "kind": "auto",
          "label": "Read expense",
          "command_template": "hb expense get {expense_key}"
        },
        {
          "kind": "user",
          "label": "Verify: Expense details match what was entered"
        },
        {
          "kind": "auto",
          "label": "Update expense",
          "command_template": "hb expense update {expense_key} --amount 30.00 --notes \"UAT Expense 01 Updated\""
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created for update",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Updated expense appears in Windows app AND mobile app"
        },
        {
          "kind": "auto",
          "label": "Delete expense",
          "command_template": "hb expense delete {expense_key} --yes"
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created for delete",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Expense removed from Windows app AND mobile app"
        }
      ]
    },
    {
      "id": "uat_income_crud",
      "title": "UAT: Income CRUD with sync validation",
      "resource": "income",
      "steps": [
        {
          "kind": "user",
          "label": "Record income count from both Windows and mobile apps, ensure mobile is on WiFi. NOTE: HomeBudget UI will close automatically during each CLI operation and reopen when complete."
        },
        {
          "kind": "auto",
          "label": "Create test income",
          "command": "hb income add --date 2026-02-17 --name \"Profit and Loss\" --amount 1000.00 --account \"TWH IB USD\" --notes UAT_Income_Create_01"
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created with AddIncome operation",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: New income (1000 USD) appears in Windows app AND mobile app"
        },
        {
          "kind": "auto",
          "label": "List incomes to get key",
          "command": "hb income list --start-date 2026-02-17 --end-date 2026-02-17 --limit 5"
        },
        {
          "kind": "user",
          "label": "Record the income key"
        },
        {
          "kind": "auto",
          "label": "Read income",
          "command_template": "hb income get {income_key}"
        },
        {
          "kind": "user",
          "label": "Verify: Income details match what was entered"
        },
        {
          "kind": "auto",
          "label": "Update income",
          "command_template": "hb income update {income_key} --amount 1050.00 --notes UAT_Income_Updated_01"
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created for update",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Updated income appears in Windows app AND mobile app"
        },
        {
          "kind": "auto",
          "label": "Delete income",
          "command_template": "hb income delete {income_key} --yes"
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created for delete",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Income removed from Windows app AND mobile app"
        }
      ]
    },
    {
      "id": "uat_transfer_crud",
      "title": "UAT: Transfer CRUD with sync validation",
      "resource": "transfer",
      "steps": [
        {
          "kind": "user",
          "label": "Record transfer count from both Windows and mobile apps, ensure mobile is on WiFi"
        },
        {
          "kind": "auto",
          "label": "Create test transfer",
          "command": "hb transfer add --date 2026-02-17 --from-account \"TWH - Personal\" --to-account \"30 CC Hashemis\" --amount 100.00 --notes \"UAT Transfer Create 01\""
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: New transfer appears in Windows app AND mobile app"
        },
        {
          "kind": "auto",
          "label": "List transfers to get key",
          "command": "hb transfer list --start-date 2026-02-17 --end-date 2026-02-17 --limit 5"
        },
        {
          "kind": "user",
          "label": "Record the transfer key"
        },
        {
          "kind": "auto",
          "label": "Read transfer",
          "command_template": "hb transfer get {transfer_key}"
        },
        {
          "kind": "user",
          "label": "Verify: Transfer details match what was entered"
        },
        {
          "kind": "auto",
          "label": "Update transfer",
          "command_template": "hb transfer update {transfer_key} --amount 150.00 --notes \"UAT Transfer Updated 01\""
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created for update",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Updated transfer appears in Windows app AND mobile app"
        },
        {
          "kind": "auto",
          "label": "Delete transfer",
          "command_template": "hb transfer delete {transfer_key} --yes"
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created for delete",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Transfer removed from Windows app AND mobile app"
        }
      ]
    },
    {
      "id": "uat_expense_currency_usd",
      "title": "UAT: Expense CRUD with USD foreign currency",
      "resource": "expense_currency",
      "steps": [
        {
          "kind": "user",
          "label": "Ensure mobile app is on WiFi and synced"
        },
        {
          "kind": "auto",
          "label": "Create expense in USD foreign currency",
          "command": "hb expense add --date 2026-02-17 --category \"Food (Basic)\" --subcategory \"Cheap restaurant\" --currency-amount 27.50 --exchange-rate 0.9273 --currency USD --account \"TWH - Personal\" --notes \"UAT Currency Test 01 - USD 27.50\""
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: New expense appears in Windows app with currency info AND appears on mobile app"
        },
        {
          "kind": "auto",
          "label": "List expenses to get key",
          "command": "hb expense list --start-date 2026-02-17 --end-date 2026-02-17 --account \"TWH - Personal\" --limit 5"
        },
        {
          "kind": "user",
          "label": "Record the currency expense key"
        },
        {
          "kind": "auto",
          "label": "Read expense and verify currency fields",
          "command_template": "hb expense get {expense_key}"
        },
        {
          "kind": "user",
          "label": "Verify: Currency=USD and currencyAmount=27.50 are preserved in the record"
        },
        {
          "kind": "auto",
          "label": "Delete currency expense",
          "command_template": "hb expense delete {expense_key} --yes"
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created for delete",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Currency expense removed from Windows app AND mobile app"
        }
      ]
    },
    {
      "id": "uat_income_currency_usd",
      "title": "UAT: Income CRUD with USD foreign currency",
      "resource": "income_currency",
      "steps": [
        {
          "kind": "user",
          "label": "Record income count from both Windows and mobile apps, ensure mobile is on WiFi"
        },
        {
          "kind": "auto",
          "label": "Create income in USD foreign currency with conversion",
          "command": "hb income add --date 2026-02-17 --name \"Profit and Loss\" --currency-amount 2700.00 --exchange-rate 0.7407 --currency USD --account \"TWH DBS Multi SGD\" --notes USD_conversion"
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created with forex fields",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: New income appears in Windows app with currency conversion (2000 SGD, 2700 USD) AND appears on mobile app"
        },
        {
          "kind": "auto",
          "label": "List incomes to get key",
          "command": "hb income list --start-date 2026-02-17 --end-date 2026-02-17 --limit 5"
        },
        {
          "kind": "user",
          "label": "Record the forex income key"
        },
        {
          "kind": "auto",
          "label": "Read forex income and verify currency fields",
          "command_template": "hb income get {income_key}"
        },
        {
          "kind": "user",
          "label": "Verify: Currency=USD, amount=2000.00, currencyAmount=2700.00 are preserved in the record"
        },
        {
          "kind": "auto",
          "label": "Delete forex income",
          "command_template": "hb income delete {income_key} --yes"
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created for forex delete",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Forex income removed from Windows app AND mobile app"
        }
      ]
    },
    {
      "id": "uat_transfer_currency_usd",
      "title": "UAT: Transfer CRUD with USD foreign currency",
      "resource": "transfer_currency",
      "steps": [
        {
          "kind": "user",
          "label": "Record transfer count from both Windows and mobile apps, ensure mobile is on WiFi"
        },
        {
          "kind": "auto",
          "label": "Create transfer in USD foreign currency",
          "command": "hb transfer add --date 2026-02-17 --from-account \"TWH - Personal\" --to-account \"30 CC Hashemis\" --currency-amount 110.00 --exchange-rate 0.9091 --currency USD --notes \"UAT Currency Test 01 - USD 110.00\""
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: New transfer appears in Windows app with currency info AND appears on mobile app"
        },
        {
          "kind": "auto",
          "label": "List transfers to get key",
          "command": "hb transfer list --start-date 2026-02-17 --end-date 2026-02-17 --limit 5"
        },
        {
          "kind": "user",
          "label": "Record the currency transfer key"
        },
        {
          "kind": "auto",
          "label": "Read transfer and verify currency fields",
          "command_template": "hb transfer get {transfer_key}"
        },
        {
          "kind": "user",
          "label": "Verify: Currency=USD and currencyAmount=110.00 are preserved in the record"
        },
        {
          "kind": "auto",
          "label": "Delete currency transfer",
          "command_template": "hb transfer delete {transfer_key} --yes"
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created for delete",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Currency transfer removed from Windows app AND mobile app"
        }
      ]
    },
    {
      "id": "uat_batch_mixed_operations",
      "title": "UAT: Mixed batch operations across resources",
      "steps": [
        {
          "kind": "auto",
          "label": "Run batch step 1 - add expense",
          "command": "hb batch run --file tests/manual/batch_templates/step1_add_expense.json"
        },
        {
          "kind": "user",
          "label": "Verify batch step 1 completed successfully in both apps"
        },
        {
          "kind": "auto",
          "label": "List expenses to get key",
          "command": "hb expense list --start-date 2026-02-20 --end-date 2026-02-20 --account \"TWH - Personal\" --limit 5"
        },
        {
          "kind": "user",
          "label": "Record the expense key"
        },
        {
          "kind": "auto",
          "label": "Run batch step 2 - update expense",
          "template": "batch_templates/step2_update_expense.json",
          "template_command": "hb batch run --file",
          "command": "hb batch run --file tests/manual/results/batch_step2.json"
        },
        {
          "kind": "user",
          "label": "Verify batch step 2 (expense update) completed successfully in both apps"
        },
        {
          "kind": "auto",
          "label": "Run batch step 3 - delete expense, add income and transfers",
          "template": "batch_templates/step3_mixed_operations.json",
          "template_command": "hb batch run --file",
          "command": "hb batch run --file tests/manual/results/batch_step3.json"
        },
        {
          "kind": "user",
          "label": "Verify batch step 3 (delete expense, add income, add 2 transfers) completed successfully in both apps"
        },
        {
          "kind": "auto",
          "label": "List incomes to get key",
          "command": "hb income list --start-date 2026-02-20 --end-date 2026-02-20 --limit 5"
        },
        {
          "kind": "user",
          "label": "Record the income key"
        },
        {
          "kind": "auto",
          "label": "List transfers to get keys",
          "command": "hb transfer list --start-date 2026-02-20 --end-date 2026-02-20 --limit 10"
        },
        {
          "kind": "user",
          "label": "Record transfer keys (comma-separated, e.g., 11457,11458)"
        },
        {
          "kind": "auto",
          "label": "Run rollback batch - remove income and transfers",
          "template": "batch_templates/rollback_operations.json",
          "template_command": "hb batch run --file",
          "command": "hb batch run --file tests/manual/results/batch_rollback.json"
        },
        {
          "kind": "user",
          "label": "Verify batch operations completed and test data is removed"
        }
      ]
    },
    {
      "id": "uat_batch_import_csv",
      "title": "UAT: Batch import CSV with sync validation",
      "resource": "batch",
      "steps": [
        {
          "kind": "user",
          "label": "Record expense count from both Windows and mobile apps, ensure mobile is on WiFi"
        },
        {
          "kind": "auto",
          "label": "Create sample CSV file",
          "command": "python -c \"from pathlib import Path; Path('tests/manual/results').mkdir(parents=True, exist_ok=True); Path('tests/manual/results/batch_expenses.csv').write_text('date,category,subcategory,amount,account,notes\\n2026-02-17,Food (Basic),Cheap restaurant,15.00,TWH - Personal,Batch test 01\\n2026-02-17,Food (Basic),Cheap restaurant,12.50,TWH - Personal,Batch test 02\\n', encoding='utf-8')\""
        },
        {
          "kind": "auto",
          "label": "Import batch CSV",
          "command": "hb expense batch-import --file tests/manual/results/batch_expenses.csv --format csv"
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate entries created",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: All transactions appear in Windows app AND mobile app after sync"
        }
      ]
    },
    {
      "id": "uat_forex_expense_amount_only",
      "title": "UAT: Forex expense amount only with inferred rate",
      "resource": "expense_forex",
      "steps": [
        {
          "kind": "user",
          "label": "Ensure mobile app is on WiFi and synced"
        },
        {
          "kind": "auto",
          "label": "Create expense on USD account with amount only",
          "command": "hb expense add --date 2026-02-20 --category \"Food (Basic)\" --subcategory \"Cheap restaurant\" --amount 25.50 --account \"TWH IB USD\" --notes \"UAT Forex Expense Amount Only\""
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Expense appears in Windows and mobile apps with currency USD, currency amount 25.50, and converted base amount"
        },
        {
          "kind": "auto",
          "label": "List expenses to get key",
          "command": "hb expense list --start-date 2026-02-20 --end-date 2026-02-20 --account \"TWH IB USD\" --limit 5"
        },
        {
          "kind": "user",
          "label": "Record the forex expense key"
        },
        {
          "kind": "auto",
          "label": "Read forex expense",
          "command_template": "hb expense get {expense_key}"
        },
        {
          "kind": "user",
          "label": "Verify: Currency fields are present and amount reflects conversion"
        },
        {
          "kind": "auto",
          "label": "Delete forex expense",
          "command_template": "hb expense delete {expense_key} --yes"
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created for delete",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Forex expense removed from Windows app and mobile app"
        }
      ]
    },
    {
      "id": "uat_forex_income_amount_only",
      "title": "UAT: Forex income amount only with inferred rate",
      "resource": "income_forex",
      "steps": [
        {
          "kind": "user",
          "label": "Ensure mobile app is on WiFi and synced"
        },
        {
          "kind": "auto",
          "label": "Create income on USD account with amount only",
          "command": "hb income add --date 2026-02-20 --name \"Salary and Wages\" --amount 1000.00 --account \"TWH IB USD\" --notes \"UAT Forex Income Amount Only\""
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Income appears in Windows and mobile apps with currency USD, currency amount 1000.00, and converted base amount"
        },
        {
          "kind": "auto",
          "label": "List incomes to get key",
          "command": "hb income list --start-date 2026-02-20 --end-date 2026-02-20 --limit 5"
        },
        {
          "kind": "user",
          "label": "Record the forex income key"
        },
        {
          "kind": "auto",
          "label": "Read forex income",
          "command_template": "hb income get {income_key}"
        },
        {
          "kind": "user",
          "label": "Verify: Currency fields are present and amount reflects conversion"
        },
        {
          "kind": "auto",
          "label": "Delete forex income",
          "command_template": "hb income delete {income_key} --yes"
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created for delete",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Forex income removed from Windows app and mobile app"
        }
      ]
    },
    {
      "id": "uat_forex_transfer_amount_only",
      "title": "UAT: Forex transfer amount only with inferred rate",
      "resource": "transfer_forex",
      "steps": [
        {
          "kind": "user",
          "label": "Ensure mobile app is on WiFi and synced"
        },
        {
          "kind": "auto",
          "label": "Create transfer from base to USD account with amount only",
          "command": "hb transfer add --date 2026-02-20 --from-account \"TWH - Personal\" --to-account \"TWH IB USD\" --amount 100.00 --notes \"UAT Forex Transfer Amount Only\""
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Transfer appears in Windows and mobile apps with currency USD and calculated currency amount"
        },
        {
          "kind": "auto",
          "label": "List transfers to get key",
          "command": "hb transfer list --start-date 2026-02-20 --end-date 2026-02-20 --limit 5"
        },
        {
          "kind": "user",
          "label": "Record the forex transfer key"
        },
        {
          "kind": "auto",
          "label": "Read forex transfer",
          "command_template": "hb transfer get {transfer_key}"
        },
        {
          "kind": "user",
          "label": "Verify: Currency fields are present and currency amount is calculated"
        },
        {
          "kind": "auto",
          "label": "Delete forex transfer",
          "command_template": "hb transfer delete {transfer_key} --yes"
        },
        {
          "kind": "auto",
          "label": "Verify SyncUpdate created for delete",
          "command": "python tests/manual/verify_syncupdate.py"
        },
        {
          "kind": "user",
          "label": "Verify: Forex transfer removed from Windows app and mobile app"
        }
      ]
    },
    {
      "id": "uat_forex_base_account_validation",
      "title": "UAT: Base account foreign transaction validation",
      "resource": "forex_validation",
      "steps": [
        {
          "kind": "user",
          "label": "Attempt to add a base account transaction with currency set to USD and no currency amount, verify an error and no data written"
        }
      ]
    }
  ]
}
